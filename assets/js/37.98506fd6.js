(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{452:function(n,a,t){"use strict";t.r(a);var e=t(18),s=Object(e.a)({},(function(){var n=this,a=n.$createElement,t=n._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("h2",{attrs:{id:"javascript设计模式-前奏"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#javascript设计模式-前奏"}},[n._v("#")]),n._v(" JavaScript设计模式--前奏")]),n._v(" "),t("p",[t("strong",[n._v("设计模式应遵守的原则：")]),n._v("\n（1）最少知识原则：一个软件实体应当尽可能少地与其他实体发生相互作用（把对象划分成较小的粒度，以便提高复用性）\n（2）开放-封闭原则：软件实体（类、模块、函数）等应该是可以扩展的，但是不可修改。")]),n._v(" "),t("p",[n._v("一、原型模式")]),n._v(" "),t("p",[n._v("JavaScript基于原型的委托机制实现对象与对象之间的继承。\n当对象无法响应某个请求时，会把该请求委托给它自己的原型。\n构造器有原型，实例对象没有原型，有一个名为"),t("strong",[n._v("proto")]),n._v("的属性，其默认指向它的构造器的原型对象，即{constructor}.prototype。\n"),t("strong",[n._v("示例一：")])]),n._v(" "),t("blockquote",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('var obj = {name: "ligang"};var A = function() {};\nA.prototype = obj;var a = new A();\nconsole.log(a.name);  // ligang\n')])])])]),n._v(" "),t("p",[n._v("（1）遍历对象a中所有属性，未找到name属性\n（2）查找name属性的请求被委托给对象a的对象构造器的原型，它被a."),t("strong",[n._v("proto")]),n._v("记录着并且指向A.prototype，而其被设置为对象obj\n（3）在对象obj中找到name属性，并返回。\n"),t("strong",[n._v("示例二：")])]),n._v(" "),t("blockquote",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('var obj = {name: "ligang"};var A = function(name) {\n    this.name = name;\n};\nA.prototype = obj;var a = new A();\nconsole.log(a.name);  // undefined\n')])])])]),n._v(" "),t("p",[n._v("（1）首选遍历对象a中的所有属性，存在name属性，但未赋值")]),n._v(" "),t("p",[t("strong",[n._v("示例三：")])]),n._v(" "),t("blockquote",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('var obj = {name: "ligang"};var A = function() {};\nA.prototype = obj;var B = function() {};\nB.prototype = new A();var b = new B();\nconsole.log(b.name);    // ligang\n')])])])]),n._v(" "),t("p",[n._v("查找顺序：\nb对象 –> b."),t("strong",[n._v("proto")]),n._v("(即：B.prototype) –> new A()对象 –> B.prototype –> obj")]),n._v(" "),t("p",[n._v("二、this")]),n._v(" "),t("h2",{attrs:{id:"_1-词法作用域"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-词法作用域"}},[n._v("#")]),n._v(" 1. 词法作用域")]),n._v(" "),t("p",[n._v("首先明确JavaScript只具备词法作用域（书写代码时函数声明的位置来决定），不具备动态作用域。通过下述示例说明。\n备注：词法作用域详见：《JavaScript词法作用域（你不知道的JavaScript）》\n"),t("strong",[n._v("示例一：")])]),n._v(" "),t("blockquote",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("function foo() {\n    console.log(a);\n}function bar() {\n    var a = 1;\n    foo();  \n}\nbar();      // ReferenceError\n")])])])]),n._v(" "),t("p",[t("strong",[n._v("示例二：")])]),n._v(" "),t("blockquote",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("function foo() {\n    console.log(this.a);        \n// this指向window\n}\nfunction bar() {\n    var a = 1;\n    foo();  \n}\nbar();     \n // undefined\n")])])])]),n._v(" "),t("p",[t("strong",[n._v("示例三：")])]),n._v(" "),t("blockquote",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("function foo() {\n    console.log(this.a);\n}function bar() {\n    this.a = 1;\n    foo();\n}\nbar();      // 1\n")])])])]),n._v(" "),t("p",[n._v("如果JavaScript存在动态作用域，示例一的结果应该为1。")]),n._v(" "),t("h2",{attrs:{id:"_2-this"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-this"}},[n._v("#")]),n._v(" 2. this")]),n._v(" "),t("p",[n._v("下面补充几点this注意事项\n备注：关于this详见：《JavaScript中的this（你不知道的JavaScript）》")]),n._v(" "),t("p",[n._v("（1）this指向（构造器调用）\n"),t("strong",[n._v("示例一：")])]),n._v(" "),t("blockquote",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('var MyClass = function() {\n    this.age = 25;    this.name = "ligang";\n};var obj = new MyClass();\nconsole.log("姓名：" +　obj.name + " 年龄：" + obj.age);  \n // 姓名：ligang    年龄：25\n')])])])]),n._v(" "),t("p",[t("strong",[n._v("示例二：")])]),n._v(" "),t("blockquote",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('var MyClass = function() {\n    this.age = 25;    this.name = "ligang";    return {\n        name: "camile"\n    };\n};var obj = new MyClass();\nconsole.log("姓名：" +　obj.name + " 年龄：" + obj.age);   \n// 姓名：camile 年龄：undefined\n')])])])]),n._v(" "),t("p",[n._v("**注意：**如果构造器显式地返回一个object类型的对象，那么此次运算最终返回这个对象，而不是我们之前期待的this。")]),n._v(" "),t("h2",{attrs:{id:"_3-指定函数内部this指向"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-指定函数内部this指向"}},[n._v("#")]),n._v(" 3. 指定函数内部this指向")]),n._v(" "),t("p",[n._v("call、apply、Function.prototype.bind\n其中Function.prototype.bind部分浏览器不兼容，兼容性请查看http://caniuse.com/\n"),t("strong",[n._v("模拟实现Function.prototype.bind：")])]),n._v(" "),t("blockquote",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('Function.prototype.bind = function() {\n    var self = this,\n        context = [].shift.call(arguments),\n        args = [].slice.call(arguments);    \nreturn function() {\n        return self.apply(context, \n[].concat.call(args, \n[].slice.call(arguments)));\n    };\n};\n// 测试\nvar obj = {\n    name: "ligang"};\nvar func = function(a, b, c) {\n    console.log(this.name);\n    console.log([a, b, c])\n}.bind(obj, 1, 2);\n\nfunc(3);\n')])])])]),n._v(" "),t("p",[n._v("三、闭包和高阶函数")]),n._v(" "),t("h2",{attrs:{id:"_1-闭包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-闭包"}},[n._v("#")]),n._v(" 1. 闭包")]),n._v(" "),t("p",[n._v("对象以方法的形式包含了过程，而闭包则是在过程中一环境的形式包含了数据。\n"),t("strong",[n._v("示例：缓存机制")])]),n._v(" "),t("blockquote",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('var mult = (function() {\n    var cache = {};    return function() {\n        var args = Array.prototype.join.call(arguments, ",");   \n     if(args in cache) {            \n     return cache[args];\n        }       \n var a = 1;       \n  for(var i = 0,\n   l = arguments.length; i < l; i++) {\n            a = a * arguments[i];\n        }        return cache[args] = a;\n    }\n})();\n\nconsole.log(mult(1, 2, 3));\nconsole.log(mult(1, 2, 3));     \n// 再次计算，直接从缓存中取\n')])])])]),n._v(" "),t("p",[n._v("**注意：**闭包容易导致循环引用，从而导致内存溢出。可以通过把这些变量置为null，回收这些变量。")]),n._v(" "),t("h2",{attrs:{id:"_2-高阶函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-高阶函数"}},[n._v("#")]),n._v(" 2. 高阶函数")]),n._v(" "),t("p",[n._v("高阶函数：函数作为参数传递；函数作为返回值输出。\n（1）回调函数")]),n._v(" "),t("blockquote",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("function fun(callback) {\n    console.log(1);    \nif(typeof callback === 'function'){\n        setTimeout(function() {\n            callback();\n        });\n    }\n}\n\nfun(function(){console.log(2);});\n")])])])]),n._v(" "),t("p",[n._v("（2）判断数据类型")]),n._v(" "),t("blockquote",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('var isType = function(type) {return function(obj) {\n return Object.prototype.toString.call(obj) === \'[object\' + type + \']\';\n    }\n};\nvar isArray = isType("Array");\nvar isNumber = isType("Number");\n\nisArray([]);\nisNumber("123");\n')])])])]),n._v(" "),t("p",[n._v("（3）单例")]),n._v(" "),t("blockquote",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("var getSingle = function(fn) {\n    var result;    \nreturn function() {\n        return result || (result = fn.apply(this, arguments));\n    };\n};\nfunction testSingle(){}\ngetSingle(testSingle)() === getSingle(testSingle)();   \n // true\n")])])])])])}),[],!1,null,null,null);a.default=s.exports}}]);